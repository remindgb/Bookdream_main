<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="UserDAO"> 

	<resultMap type="user" id="userResult">
		<result property="user_id" column="user_id"/>
		<result property="user_password" column="user_password"/>
		<result property="user_name" column="user_name"/>
		<result property="user_address" column="user_address"/>
		<result property="user_tel" column="user_tel"/>
		<result property="user_level" column="user_level"/>
		<result property="flatform_type" column="flatform_type"/>		
		<result property="user_email" column="user_email"/>
	</resultMap>

	<insert id="insertUser">
		insert into users(USER_NO, USER_ID, USER_PASSWORD, USER_NAME, USER_ADDRESS, USER_TEL, FLATFORM_TYPE, USER_EMAIL) 
		values(user_seq.nextval,#{user_id},#{user_password},#{user_name},'','','BD',#{user_email})
	</insert>
	
	<select id="idCheck" resultType="int">
		select count(user_id) from users where user_id = #{user_id}
	</select>
	
	<select id="getUser" resultType="user">
			select * 
			from users 
			where user_id=#{user_id} and user_password=#{user_password}
	</select>
	
	<select id="loginCheck" resultType="String">
		select user_name
		from users
		where user_id=#{user_id} and user_password=#{user_password}
	</select>
	
	<!-- 카카오 정보 찾기 -->
	<select id="findKakao" parameterType="java.util.HashMap" resultType="user">
		select user_name, user_email from users where user_name=#{nickname} and user_email=#{email}
	</select>

	<!-- 플랫폼 정보 가져오기ㅡ -->
	<select id="findFlatform" resultType="String">
		select flatform_type from users where user_id=#{user_id} and user_password=#{user_password}
	</select>

	<!--카카오 정보 저장 -->
	<insert id="kakaoInsert" parameterType="java.util.HashMap">
		insert into users(USER_NO, USER_ID, USER_PASSWORD, USER_NAME, USER_ADDRESS, USER_TEL, FLATFORM_TYPE, USER_EMAIL) 
		values(user_seq.nextval,'','',#{nickname},'','','KAKAO',#{email})
	</insert>
</mapper>
